# Pipeline Configuration
# Centralizes all file paths, API IDs, and settings per ADR-1 (Configuration-Driven Pipeline)
# This enables non-developers to adjust config without touching code

[dirs]
raw_data = "data/00-raw"
staging = "data/01-staging"
validated = "data/02-validated"
erp_export = "data/03-erp-export"

[pipeline]
steps = ["ingest", "transform", "validate", "export"]

# Raw Sources Configuration (maps to ingest.py RAW_SOURCES)
[sources.import_export_receipts]
type = "folder"
description = "Import/Export Receipts: Year/month files with Chi tiết nhập, Chi tiết xuất, Xuất nhập tồn tabs (reconciled/cleaned)"
root_folder_id = "16CXAGzxxoBU8Ui1lXPxZoLVbDdsgwToj"
receipts_subfolder_name = "Xuất Nhập Tồn 2020-2025"
tabs = ["Chi tiết nhập", "Chi tiết xuất", "Xuất nhập tồn", "Chi tiết chi phí"]
output_subdir = "import_export"

[sources.receivable]
type = "spreadsheet"
description = "Receivable: customer debt ledger + customer info"
root_folder_id = "16CXAGzxxoBU8Ui1lXPxZoLVbDdsgwToj"
spreadsheet_name = "Receivable.xlsx"
spreadsheet_id = "1kouZwJy8P_zZhjjn49Lfbp3KN81mhHADV7VKDhv5xkM"
output_subdir = "receivable"

[[sources.receivable.sheets]]
name = "TỔNG CÔNG NỢ"
output_file = "receivable_summary"

[[sources.receivable.sheets]]
name = "Thong tin KH"
output_file = "receivable_customers"

[sources.payable]
type = "spreadsheet"
description = "Payable: supplier master + debt ledger"
root_folder_id = "16CXAGzxxoBU8Ui1lXPxZoLVbDdsgwToj"
spreadsheet_name = "Payable.xlsx"
spreadsheet_id = "1b4LWWyfddfiMZWnFreTyC-epo17IR4lcbUnPpLW8X00"
output_subdir = "payable"

[[sources.payable.sheets]]
name = "MÃ CTY"
output_file = "payable_master"

[[sources.payable.sheets]]
name = "TỔNG HỢP"
output_file = "payable_summary"

[sources.cashflow]
type = "spreadsheet"
description = "CashFlow: deposits and cash transactions"
root_folder_id = "16CXAGzxxoBU8Ui1lXPxZoLVbDdsgwToj"
spreadsheet_name = "Cashflow.xlsx"
output_subdir = "cashflow"

[[sources.cashflow.sheets]]
name = "Tiền gửi"
output_file = "cashflow_deposits"

[[sources.cashflow.sheets]]
name = "Tien mat"
output_file = "cashflow_cash"

# External data sources for enrichment
[enrichment]
product_lookup_spreadsheet_id = "16bGN2gjWspCqlFD4xB--7WtkYtTpDaWzRQx9sV97ed8"
product_lookup_sheet_gid = 23224859

# Migration filter settings for products.xlsx export
[migration_filter]
sales_recency_threshold = "2025-01-01"
min_inventory_qty = 0
product_code_prefix = "SPC"

# Customer export settings
[customer_export]
transaction_cutoff_date = "2024-01-01"

# Opening balance generation settings (auto-detects earliest month from inventory)
[opening_balance]
receipt_date = "2020-03-31"
receipt_code_prefix = "PN-OB"
supplier_name = "Kho đầu kỳ"
quantity_price_tolerance_pct = 5.0

[upload]
google_sheets_id_reports = "11vk-p0iL9JcNH180n4uV5VTuPnhJ97lBgsLEfCnWx_k"
